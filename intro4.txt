now in new branch , modified version